---
sidebar_label: Glides
sidebar_position: 1
---

import DocCard from "@theme/DocCard";

# Glides Events

Information about Green Line operations, such as trainsheets, published by [Glides](https://github.com/mbta/glides).

Originally defined in [RFC 18](https://github.com/mbta/technology-docs/blob/main/rfcs/accepted/0018-glides-trainsheet-events.md).

These events are primarily published so that RTR can consume it to improve public predictions and realtime data. Other applications may find other uses for the data.

## Events

### trips_updated

Published when Glides has new information about trips, for example operator assignments or dropped trips. Consumers who want to know what trains are running should pay attention to this event, and don't need to pay attention to any other events.

<DocCard
  item={{
    type: "link",
    label: "com.mbta.ctd.glides.trips_updated.v1",
    href: "/events/glides/com.mbta.ctd.glides.trips_updated.v1",
    docId: "events/glides/com.mbta.ctd.glides.trips_updated.v1",
  }}
/>

### editors_changed

Published when there's a change to which inspectors are editing a trainsheet.

<DocCard
  item={{
    type: "link",
    label: "com.mbta.ctd.glides.editors_changed.v1",
    href: "/events/glides/com.mbta.ctd.glides.editors_changed.v1",
    docId: "events/glides/com.mbta.ctd.glides.editors_changed.v1",
  }}
/>

### operator_signed_in

Published when an operator signs in as fit for duty.

<DocCard
  item={{
    type: "link",
    label: "com.mbta.ctd.glides.operator_signed_in.v1",
    href: "/events/glides/com.mbta.ctd.glides.operator_signed_in.v1",
    docId: "events/glides/com.mbta.ctd.glides.operator_signed_in.v1",
  }}
/>

## Shared Types

### GlidesUser

Fields:

- `emailAddress` (string): the e-mail of the user.
- `badgeNumber` (string, optional): the badge number of the user. Not all Glides users have a badge number (for example, CTD contractors).

### Location

One of:

- `{"gtfsId": "<GTFS stop ID>"}`, where the GTFS `location_type` is `1` (station).
- `{"odsId": "<ODS stop ID"}`: id corresponding to `ops_location_id` in the upcoming ODS data. The data is still undergoing development and the specific ids are not yet finalized.

Glides does not collect or publish any location data with GTFS `location_type` `0` (platform).

### Metadata

Information about how the event was created by Glides. All important outputs from Glides will be elsewhere in the event data, but data here might be useful for consumers who care about how inspectors are using Glides.

All fields are optional and Glides MAY choose not to include any of them on any event.

Fields:

- `author` ([GlidesUser](#glidesuser), optional): The logged-in user whose action triggered the event.
- `inputTimestamp` (RFC3999 timestamp, optional): The timestamp that the user entered the data into Glides, as reported by their device. You probably want to use the event time instead. See [more explanation](#a-note-about-inputtimestamp) below.
- `inputType` (string, optional): the action that the user did in Glides. This field exists because the event data on its own may not specify how the data was entered, for example all trainsheet updates are normalized into a generic format in `tripUpdates`. Example values for this field are `"add-trip"` or `"manage-headways"`, but no guarantees are given about what strings will be used or which actions the field will be populated for.
- `location` ([Location](#location), optional): the location the logged-in user is managing.

#### A note about `inputTimestamp`

The `inputTimestamp` field is reported by the Glides user's device, and is different from the `time` field in the event, which is the server-reported time that the Glides server received the input.
They could differ if sending the input was delayed due to network problems, or if the device's clock is wrong.

Consumers are recommended to use the server-reported event time for most use cases, and not this client-reported `inputTimestamp` field, because:

- The `inputTimestamp` is generated by the client device, and so is in some sense less trustworthy. What if a client's clock is set wrong? We don't do any validation, and we can't, because we can't tell the difference between an incorrect time and a correct time that was delayed by network issues. This isn't so much a specific concern as a general practice of not depending on non-validated client data.
- Glides applies updates in the order they're received. If a consumer applies events based on client-provided timestamps, they could apply events in a different order than Glides and end up with incorrect results about the state of a trip.
- The CloudEvents docs seem to say that the event time's consistency is more important than it being the original occurence time. Server-provided times will be more consistent than client-provided times.

CloudEvents [`suggests`](https://github.com/cloudevents/spec/blob/v1.0.2/cloudevents/spec.md#time) that the event time should be "when the occurence happened", which would be when the input was made,
but for the reasons above, Glides uses a server-reported time as the event time and separates the client-reported `inputTime` into `metadata`.

### Operator

Fields:

- `badgeNumber` (string)

MAY refer to other non-operator Area 132 employees in some cases, for example if an inspector signs in as fit for duty in Glides (they aren't required to).

It is represented as an object to provide future extensibility if needed.
